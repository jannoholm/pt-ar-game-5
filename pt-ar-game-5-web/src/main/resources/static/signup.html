<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="">
	<meta name="author" content="">
	<link rel="icon" href="favicon.ico">

    <title>Trivia Spree Signup</title>

	<!-- Bootstrap core CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css"
		integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdn.datatables.net/1.10.16/css/dataTables.bootstrap4.min.css"
		crossorigin="anonymous">

	<style type="text/css">
		body {
			padding-top: 5rem;
			/* color: #fff; */
		}

		.starter-template {
			padding: 3rem 1.5rem;
			text-align: center;
		}

		.bg {
			/* The image used */
			background-image: url("bg-leaderboard.jpg");

			/* Full height */
			height: 100%;


			/* Center and scale the image nicely */
			background-color: #09060f00;
			background-repeat: no-repeat;
			background-attachment: fixed;
			background-position: center;
			background-size: contain;
			opacity: .8;
		}

		main {
			position: absolute;
			top: 50%;
			transform: translateY(-50%);
		}

		.btn {
			width: 100%
		}

		input {
			min-width: 260px;
		}

		.btn-primary {
			color: #fff;
			background-color: #ff6207;
			border-color: #ff4007;
		}

		.btn {
			font-size: 2rem;
		}

		.form-control {
			font-size: 2rem;
		}

		#add_nickname_field {
			text-transform: uppercase;
		}

		#add_nickname_field:-ms-input-placeholder {
			text-transform: none;
		}

		#add_nickname_field::placeholder {
			text-transform: none;
		}

		@media (max-width: 575px) {
			#recieve_offers_field {
				margin-left: calc(50% - 15px) !important;
			}

			#choice_cointainer {
				white-space: initial !important;
			}
		}
	</style>
	
	<link href="https://unpkg.com/nes.css@latest/css/nes.min.css" rel="stylesheet" />
	  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Press+Start+2P">
	  <style>
		  html, body, pre, code, kbd, samp {
			  font-family: 'Press Start 2P', serif;;
		  }
	  </style>

</head>

<body class="bg">
	<main role="main" class="" style="height: 100%;">
		<div class="starter-template">
			<div class="alert alert-success alert-dismissible fade show" role="alert" style="display:none">
				<button type="button" class="close" data-dismiss="alert" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				<strong>Player added successfully!</strong>
			</div>
			<form class="form-inline pull-left" style="padding-left: 1rem" id="add_player_form">

				<table>

					<tr>
						<td>
							<label class="sr-only" for="add_nickname_field">Game nickname (3 characters)</label>
							<div class="input-group mb-2 mr-sm-2 mb-sm-0">
								<input type="text" class="form-control nes-input" id="add_nickname_field"
									placeholder="3 char nickname" pattern="[a-zA-Z]{3}" maxlength="3" required>
							</div>
						</td>
					</tr>

					<tr>
						<td>
							<label class="sr-only" for="add_name_field">Name</label>
							<div class="input-group mb-2 mr-sm-2 mb-sm-0">
								<input type="text" class="form-control nes-input" id="add_name_field" placeholder="Contact name"
									required>
							</div>
						</td>
					</tr>


					<tr>
						<td>
							<label class="sr-only" for="add_email_field">Email</label>
							<div class="input-group mb-2 mr-sm-2 mb-sm-0">
								<input type="email" class="form-control nes-input" id="add_email_field"
									placeholder="Contact e-mail" required>
							</div>
						</td>
					</tr>



					<tr style="display: none;">
						<td>
							<div class="form-control mb-2 mr-sm-2 mb-sm-0">
								<label>
									I wish to receive information about open positions at Playtech
									<input style="min-width: 30px; width: 30px; height: 30px; margin-left: 10px;"
										type="checkbox" class="form-control" id="recieve_offers_field" align="middle">
								</label>

								<div id="choice_cointainer" style="display: none; white-space: nowrap">
									<hr />
									<table style="width:min-content; margin-left: auto; margin-right: auto;">
										<tr>
											<td>
												Development
											</td>
											<td>
												<input
													style="min-width: 30px; width: 30px; height: 30px; margin-left: 10px;"
													type="checkbox" class="form-control" id="dev">
											</td>
										</tr>
										<tr>
											<td>
												Project Management
											</td>
											<td>
												<input
													style="min-width: 30px; width: 30px; height: 30px; margin-left: 10px;"
													type="checkbox" class="form-control" id="p_manage">
											</td>
										</tr>
										<tr>
											<td>
												Analysis
											</td>
											<td>
												<input
													style="min-width: 30px; width: 30px; height: 30px; margin-left: 10px;"
													type="checkbox" class="form-control" id="ana">
											</td>
										</tr>
										<tr>
											<td>
												DevOps
											</td>
											<td>
												<input
													style="min-width: 30px; width: 30px; height: 30px; margin-left: 10px;"
													type="checkbox" class="form-control" id="devops">
											</td>
										</tr>
										<tr>
											<td>
												Infra/Sys/Network
											</td>
											<td>
												<input
													style="min-width: 30px; width: 30px; height: 30px; margin-left: 10px;"
													type="checkbox" class="form-control" id="infra">
											</td>
										</tr>
										<tr>
											<td>
												QA
											</td>
											<td>
												<input
													style="min-width: 30px; width: 30px; height: 30px; margin-left: 10px;"
													type="checkbox" class="form-control" id="qa">
											</td>
										</tr>
										<tr>
											<td>
												Admin or HR
											</td>
											<td>
												<input
													style="min-width: 30px; width: 30px; height: 30px; margin-left: 10px;"
													type="checkbox" class="form-control" id="hr">
											</td>
										</tr>
									</table>
								</div>
							</div>
						</td>
					</tr>



					<tr>
						<td>
							<div class="mb-2 mr-sm-2">
								<button type="submit" class="btn is-success nes-btn ">Add player</button>
							</div>
						</td>
					</tr>

					<tr style="display: none;">
						<td>
							<div class="mb-2 mr-sm-2"
								style="color: lightgray; text-align:  left; max-width: 385px; background-color: #0000007d; border-radius: 4px; padding: 5px;">
								Your information will be stored only for the duration of the contest. Once the contest
								has concluded, all data will be deleted. You may not enter any personal data, if you so
								desire.
							</div>
						</td>
					</tr>
				</table>
			</form>
		</div>
	</main><!-- /.container -->


	<!-- Bootstrap core JavaScript
    ================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<!-- <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script> -->
	<script src="https://code.jquery.com/jquery-1.12.4.min.js" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/js-cookie@beta/dist/js.cookie.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js"
		integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh"
		crossorigin="anonymous"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js"
		integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ"
		crossorigin="anonymous"></script>
	<script src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
	<script src="https://cdn.datatables.net/1.10.16/js/dataTables.bootstrap4.min.js"></script>


	<script>

		var editor; // use a global for the submit and return data rendering in the examples    

		$(document).ready(function () {

			$('#recieve_offers_field').change(
				function () {
					const block = $("#choice_cointainer");
					if ($(this).is(':checked')) {
						block.show(500);
					} else {
						block.hide(500);
					}
				})

			function getInterests() {
				const consent = $('#recieve_offers_field').is(":checked");
				if (consent) {
					const dataJson = {
						consent: consent,
						development: $('#dev').is(":checked"),
						projectManagement: $('#p_manage').is(":checked"),
						analysis: $('#ana').is(":checked"),
						devOps: $('#devops').is(":checked"),
						infra: $('#infra').is(":checked"),
						qa: $('#qa').is(":checked"),
						adminHr: $('#hr').is(":checked")
					}
					return dataJson;
				}
				return undefined;
			}

			function successCallback(data) {
				console.log("Player added: " + data);
				Cookies.set("nickname", data.nickname, { expires: 28 });
				window.location.replace("index.html");
			}

			function errorCallback(data) {
				console.log("Player adding failed: " + data);
				var nicknameField = $("#add_nickname_field").get(0);
				nicknameField.setCustomValidity("Nickname exists");
				nicknameField.reportValidity();
			}

			$("#add_nickname_field").on('input', function (e) {
				// Remove custom validation error text in case user changes nickname after failed attempt
				var nicknameField = $("#add_nickname_field").get(0);
				nicknameField.setCustomValidity("");
				// TODO For some reason browser shows default error again even if submit is not done if a character is deleted for correction
			});

			$("#add_player_form").submit(function (event) {
				// Stop form from submitting normally
				event.preventDefault();

				var nicknameField = $("#add_nickname_field").get(0);
				nicknameField.setCustomValidity("");

				// Get some values from elements on the page:
				var $form = $(this);
				console.log("Adding player: " + $form.serialize());

				jsonPayload = {
					"name": $('#add_name_field').val(),
					"nickname": $('#add_nickname_field').val().toUpperCase(),
					"email": $('#add_email_field').val(),
					"interests": getInterests()
				}

				// Post the data to the server
				$.ajax({
					type: "POST",
					url: "api/player",
					contentType: 'application/json; charset=utf-8',
					data: JSON.stringify(jsonPayload),
					success: successCallback,
					error: errorCallback,
					dataType: "json"
				});

			});

		});      
	</script>


</body>

</html>